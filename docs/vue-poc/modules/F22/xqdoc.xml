<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2019-05-24T10:30:30.92+01:00</xqdoc:date><xqdoc:version>1.1</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>quodatum.test.xqdoc</xqdoc:uri><xqdoc:name>xqdocs.xqm</xqdoc:name><xqdoc:comment><xqdoc:description>job info</xqdoc:description><xqdoc:custom tag="__source">features/model/xqdocs.xqm</xqdoc:custom></xqdoc:comment><xqdoc:body>xquery version "3.1";
(:~
 : job info
 :)
 module namespace j = 'quodatum.test.xqdoc';


(:~
 :  job list (currently dummy list)
 :)
declare  
%rest:GET %rest:path("/vue-poc/api/xqdocjob")
%output:method("json")   
function j:list()
as element(json)
{
 let $jlist:=file:list(db:option("webpath") || "/static/xqdoc/")
 return &lt;json type="array"&gt;
 {for $j in reverse($jlist)
 return &lt;_ type="object"&gt;
  &lt;id&gt;{ $j }&lt;/id&gt;
  &lt;name&gt;todo&lt;/name&gt;
  &lt;href&gt;/static/xqdoc/{ $j }index.html&lt;/href&gt;
 &lt;/_&gt;
 }&lt;/json&gt;
};

(:~
 :  job info (currently dummy item)
 :)
declare  
%rest:GET %rest:path("/vue-poc/api/xqdocjob/{$job}")
%output:method("json")   
function j:job($job)
as element(json)
{
 let $j:=$job
 return &lt;json type="object"&gt;
        &lt;todo&gt;uuu&lt;/todo&gt;
        &lt;/json&gt;
};

</xqdoc:body></xqdoc:module><xqdoc:imports/><xqdoc:namespaces><xqdoc:namespace prefix="j" uri="quodatum.test.xqdoc"/><xqdoc:namespace prefix="rest" uri="http://exquery.org/ns/restxq"/><xqdoc:namespace prefix="output" uri="http://www.w3.org/2010/xslt-xquery-serialization"/></xqdoc:namespaces><xqdoc:variables/><xqdoc:functions><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description>job list (currently dummy list)</xqdoc:description></xqdoc:comment><xqdoc:name>j:list</xqdoc:name><xqdoc:annotations><xqdoc:annotation name="rest:GET"/><xqdoc:annotation name="rest:path"><xqdoc:literal type="xs:string">/vue-poc/api/xqdocjob</xqdoc:literal></xqdoc:annotation><xqdoc:annotation name="output:method"><xqdoc:literal type="xs:string">json</xqdoc:literal></xqdoc:annotation></xqdoc:annotations><xqdoc:signature>declare %rest:GET %rest:path("/vue-poc/api/xqdocjob") %output:method("json") function j:list() as element(json)</xqdoc:signature><xqdoc:return><xqdoc:type>element(json)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://expath.org/ns/file</xqdoc:uri><xqdoc:name>list</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://basex.org/modules/db</xqdoc:uri><xqdoc:name>option</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>reverse</xqdoc:name></xqdoc:invoked><xqdoc:ref-variable><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>jlist</xqdoc:name></xqdoc:ref-variable><xqdoc:ref-variable><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>j</xqdoc:name></xqdoc:ref-variable><xqdoc:ref-variable><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>j</xqdoc:name></xqdoc:ref-variable><xqdoc:body>function j:list()
as element(json)
{
 let $jlist:=file:list(db:option("webpath") || "/static/xqdoc/")
 return &lt;json type="array"&gt;
 {for $j in reverse($jlist)
 return &lt;_ type="object"&gt;
  &lt;id&gt;{ $j }&lt;/id&gt;
  &lt;name&gt;todo&lt;/name&gt;
  &lt;href&gt;/static/xqdoc/{ $j }index.html&lt;/href&gt;
 &lt;/_&gt;
 }&lt;/json&gt;
}</xqdoc:body></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description>job info (currently dummy item)</xqdoc:description></xqdoc:comment><xqdoc:name>j:job</xqdoc:name><xqdoc:annotations><xqdoc:annotation name="rest:GET"/><xqdoc:annotation name="rest:path"><xqdoc:literal type="xs:string">/vue-poc/api/xqdocjob/{$job}</xqdoc:literal></xqdoc:annotation><xqdoc:annotation name="output:method"><xqdoc:literal type="xs:string">json</xqdoc:literal></xqdoc:annotation></xqdoc:annotations><xqdoc:signature>declare %rest:GET %rest:path("/vue-poc/api/xqdocjob/{$job}") %output:method("json") function j:job($job as item()*) as element(json)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>job</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(json)</xqdoc:type></xqdoc:return><xqdoc:ref-variable><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>job</xqdoc:name></xqdoc:ref-variable><xqdoc:body>function j:job($job)
as element(json)
{
 let $j:=$job
 return &lt;json type="object"&gt;
        &lt;todo&gt;uuu&lt;/todo&gt;
        &lt;/json&gt;
}</xqdoc:body></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>