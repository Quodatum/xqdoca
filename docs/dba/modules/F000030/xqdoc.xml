<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2025-05-17T18:53:12.962+01:00</xqdoc:date><xqdoc:version>1.1</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>dba/config</xqdoc:uri><xqdoc:name>config</xqdoc:name><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
DBA configuration.&#xD;
&#xD;
</xqdoc:description><xqdoc:author>Christian Grün, BaseX Team 2005-23, BSD License</xqdoc:author></xqdoc:comment><xqdoc:body>(:~
 : DBA configuration.
 :
 : @author Christian Grün, BaseX Team 2005-23, BSD License
 :)
module namespace config = 'dba/config';

import module namespace options = 'dba/options' at 'options.xqm';

(:~ Session key. :)
declare variable $config:SESSION-KEY := 'dba';
(:~ Current directory. :)
declare %private variable $config:DIRECTORY := 'dba-directory';
(:~ Current query. :)
declare %private variable $config:QUERY := 'dba-query';

(:~
 : Returns the current working directory.
 : @return directory
 :)
declare function config:directory() as xs:string {
  let $dir := session:get($config:DIRECTORY)
  return if(exists($dir) and file:exists($dir)) then (
    $dir
  ) else (
    $options:DBA-DIRECTORY
  )
};

(:~
 : Assigns a working directory.
 : @param  $value  value
 :)
declare function config:directory(
  $value  as xs:string
) as empty-sequence() {
  session:set($config:DIRECTORY, $value)
};

(:~
 : Returns the name of the current query.
 : @return current query
 :)
declare function config:query(
) as xs:string? {
  session:get($config:QUERY)
};

(:~
 : Assigns the name of the current query.
 : @param  $value  value
 :)
declare function config:query(
  $value  as xs:string
) as empty-sequence() {
  session:set($config:QUERY, $value)
};

(:~
 : Returns the names of all files.
 : @return list of files
 :)
declare function config:query-files() as xs:string* {
  let $dir := config:directory()
  where file:exists($dir)
  return file:list($dir)[matches(., '\.xqm?$')]
};
</xqdoc:body></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>dba/options</xqdoc:uri><xqdoc:at>options.xqm</xqdoc:at></xqdoc:import></xqdoc:imports><xqdoc:namespaces><xqdoc:namespace prefix="config" uri="dba/config"/><xqdoc:namespace prefix="options" uri="dba/options"/><xqdoc:namespace prefix="xs" uri="http://www.w3.org/2001/XMLSchema"/><xqdoc:namespace prefix="session" uri="http://basex.org/modules/session"/><xqdoc:namespace prefix="file" uri="http://expath.org/ns/file"/></xqdoc:namespaces><xqdoc:variables><xqdoc:variable><xqdoc:name>config:SESSION-KEY</xqdoc:name><xqdoc:comment><xqdoc:description>&#xD;
Session key.</xqdoc:description></xqdoc:comment><xqdoc:body>variable $config:SESSION-KEY := 'dba'</xqdoc:body></xqdoc:variable><xqdoc:variable><xqdoc:name>config:DIRECTORY</xqdoc:name><xqdoc:comment><xqdoc:description>&#xD;
Current directory.</xqdoc:description></xqdoc:comment><xqdoc:annotations><xqdoc:annotation name="private"/></xqdoc:annotations><xqdoc:body>variable $config:DIRECTORY := 'dba-directory'</xqdoc:body></xqdoc:variable><xqdoc:variable><xqdoc:name>config:QUERY</xqdoc:name><xqdoc:comment><xqdoc:description>&#xD;
Current query.</xqdoc:description></xqdoc:comment><xqdoc:annotations><xqdoc:annotation name="private"/></xqdoc:annotations><xqdoc:body>variable $config:QUERY := 'dba-query'</xqdoc:body></xqdoc:variable></xqdoc:variables><xqdoc:functions><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
Returns the current working directory.&#xD;
</xqdoc:description><xqdoc:return>directory</xqdoc:return></xqdoc:comment><xqdoc:name>config:directory</xqdoc:name><xqdoc:signature>function config:directory ( ) as xs:string { let $dir := session:get($config:DIRECTORY) return if(exists($dir) and file:exists($dir)) then ( $dir ) else ( $options:DBA-DIRECTORY ) }</xqdoc:signature><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:body>function config:directory() as xs:string {
  let $dir := session:get($config:DIRECTORY)
  return if(exists($dir) and file:exists($dir)) then (
    $dir
  ) else (
    $options:DBA-DIRECTORY
  )
}</xqdoc:body></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
Assigns a working directory.&#xD;
</xqdoc:description><xqdoc:param>$value  value</xqdoc:param></xqdoc:comment><xqdoc:name>config:directory</xqdoc:name><xqdoc:signature>function config:directory ( $value as xs:string ) as empty-sequence() { session:set($config:DIRECTORY, $value) }</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>value</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence</xqdoc:type></xqdoc:return><xqdoc:body>function config:directory(
  $value  as xs:string
) as empty-sequence() {
  session:set($config:DIRECTORY, $value)
}</xqdoc:body></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
Returns the name of the current query.&#xD;
</xqdoc:description><xqdoc:return>current query</xqdoc:return></xqdoc:comment><xqdoc:name>config:query</xqdoc:name><xqdoc:signature>function config:query ( ) as xs:string? { session:get($config:QUERY) }</xqdoc:signature><xqdoc:return><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:return><xqdoc:body>function config:query(
) as xs:string? {
  session:get($config:QUERY)
}</xqdoc:body></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
Assigns the name of the current query.&#xD;
</xqdoc:description><xqdoc:param>$value  value</xqdoc:param></xqdoc:comment><xqdoc:name>config:query</xqdoc:name><xqdoc:signature>function config:query ( $value as xs:string ) as empty-sequence() { session:set($config:QUERY, $value) }</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>value</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence</xqdoc:type></xqdoc:return><xqdoc:body>function config:query(
  $value  as xs:string
) as empty-sequence() {
  session:set($config:QUERY, $value)
}</xqdoc:body></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description>&#xD;
&#xD;
Returns the names of all files.&#xD;
</xqdoc:description><xqdoc:return>list of files</xqdoc:return></xqdoc:comment><xqdoc:name>config:query-files</xqdoc:name><xqdoc:signature>function config:query-files ( ) as xs:string* { let $dir := config:directory() where file:exists($dir) return file:list($dir)[matches(., '\.xqm?$')] }</xqdoc:signature><xqdoc:return><xqdoc:type occurrence="*">xs:string</xqdoc:type></xqdoc:return><xqdoc:body>function config:query-files() as xs:string* {
  let $dir := config:directory()
  where file:exists($dir)
  return file:list($dir)[matches(., '\.xqm?$')]
}</xqdoc:body></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>