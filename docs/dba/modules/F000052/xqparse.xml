<XQuery>(:~
 : Updates user information.
 :
 : @author Christian Gr√ºn, BaseX Team 2005-23, BSD License
 :)
<Module><LibraryModule><ModuleDecl><TOKEN>module</TOKEN> <TOKEN>namespace</TOKEN> <NCName><NCName>dba</NCName></NCName> <TOKEN>=</TOKEN> <URILiteral><StringLiteral>'dba/users'</StringLiteral></URILiteral><Separator><TOKEN>;</TOKEN></Separator></ModuleDecl>

<Prolog><Import><ModuleImport><TOKEN>import</TOKEN> <TOKEN>module</TOKEN> <TOKEN>namespace</TOKEN> <NCName><NCName>util</NCName></NCName> <TOKEN>=</TOKEN> <URILiteral><StringLiteral>'dba/util'</StringLiteral></URILiteral> <TOKEN>at</TOKEN> <URILiteral><StringLiteral>'../lib/util.xqm'</StringLiteral></URILiteral></ModuleImport></Import><Separator><TOKEN>;</TOKEN></Separator>

(:~ Top category :)
<AnnotatedDecl><TOKEN>declare</TOKEN> <VarDecl><TOKEN>variable</TOKEN> <TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:CAT</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <VarValue><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'users'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></VarValue></VarDecl></AnnotatedDecl><Separator><TOKEN>;</TOKEN></Separator>
(:~ Sub category :)
<AnnotatedDecl><TOKEN>declare</TOKEN> <VarDecl><TOKEN>variable</TOKEN> <TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:SUB</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <VarValue><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'user'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></VarValue></VarDecl></AnnotatedDecl><Separator><TOKEN>;</TOKEN></Separator>

(:~
 : Updates users information.
 : @param  $info  users information
 : @return redirection
 :)
<AnnotatedDecl><TOKEN>declare</TOKEN>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><TOKEN>updating</TOKEN></FunctionName></QName></EQName></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:POST</QName></FunctionName></QName></EQName></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:path</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'/dba/users-info'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'info'</StringLiteral></Literal><TOKEN>,</TOKEN> <Literal><StringLiteral>'{$info}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
<FunctionDecl><TOKEN>function</TOKEN> <EQName><QName><FunctionName><QName>dba:users-info</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN>
  <ParamList><Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName>  <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param></ParamList>
<TOKEN>)</TOKEN> <TOKEN>as</TOKEN> <SequenceType><TOKEN>empty-sequence</TOKEN><TOKEN>(</TOKEN><TOKEN>)</TOKEN></SequenceType> <FunctionBody><EnclosedExpr><TOKEN>{</TOKEN>
  <Expr><ExprSingle><TryCatchExpr><TryClause><TOKEN>try</TOKEN> <EnclosedTryTargetExpr><EnclosedExpr><TOKEN>{</TOKEN>
    (: change user info :)
    <Expr><ExprSingle><FLWORExpr><InitialClause><LetClause><TOKEN>let</TOKEN> <LetBinding><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>dba:user-info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></LetBinding></LetClause></InitialClause>
    <IntermediateClause><WhereClause><TOKEN>where</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>not</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>deep-equal</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></WhereClause></IntermediateClause>
    <ReturnClause><TOKEN>return</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:update-info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></ReturnClause></FLWORExpr></ExprSingle><TOKEN>,</TOKEN>

    <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>util:redirect</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:CAT</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><MapConstructor><TOKEN>map</TOKEN> <TOKEN>{</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'info'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'User information was updated.'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry> <TOKEN>}</TOKEN></MapConstructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>}</TOKEN></EnclosedExpr></EnclosedTryTargetExpr></TryClause> <CatchClause><TOKEN>catch</TOKEN> <CatchErrorList><NameTest><EQName><QName><FunctionName><QName>err:FODC0006</QName></FunctionName></QName></EQName></NameTest></CatchErrorList> <EnclosedExpr><TOKEN>{</TOKEN>
    <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>util:redirect</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:CAT</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><MapConstructor><TOKEN>map</TOKEN> <TOKEN>{</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'error'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'XML with "info" root element expected.'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry> <TOKEN>}</TOKEN></MapConstructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>}</TOKEN></EnclosedExpr></CatchClause> <CatchClause><TOKEN>catch</TOKEN> <CatchErrorList><NameTest><Wildcard>*</Wildcard></NameTest></CatchErrorList> <EnclosedExpr><TOKEN>{</TOKEN>
    <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>util:redirect</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:CAT</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><MapConstructor><TOKEN>map</TOKEN> <TOKEN>{</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'error'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>err:description</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry> <TOKEN>}</TOKEN></MapConstructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>}</TOKEN></EnclosedExpr></CatchClause></TryCatchExpr></ExprSingle></Expr>
<TOKEN>}</TOKEN></EnclosedExpr></FunctionBody></FunctionDecl></AnnotatedDecl><Separator><TOKEN>;</TOKEN></Separator>

(:~
 : Updates a user.
 : @param  $name     username
 : @param  $newname  new name
 : @param  $pw       password
 : @param  $perm     permission
 : @return redirection
 :)
<AnnotatedDecl><TOKEN>declare</TOKEN>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><TOKEN>updating</TOKEN></FunctionName></QName></EQName></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:POST</QName></FunctionName></QName></EQName></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:path</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'/dba/user-update'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'name'</StringLiteral></Literal><TOKEN>,</TOKEN>    <Literal><StringLiteral>'{$name}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'newname'</StringLiteral></Literal><TOKEN>,</TOKEN> <Literal><StringLiteral>'{$newname}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'pw'</StringLiteral></Literal><TOKEN>,</TOKEN>      <Literal><StringLiteral>'{$pw}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'perm'</StringLiteral></Literal><TOKEN>,</TOKEN>    <Literal><StringLiteral>'{$perm}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
  <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>rest:form-param</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN><Literal><StringLiteral>'info'</StringLiteral></Literal><TOKEN>,</TOKEN>    <Literal><StringLiteral>'{$info}'</StringLiteral></Literal><TOKEN>)</TOKEN></Annotation>
<FunctionDecl><TOKEN>function</TOKEN> <EQName><QName><FunctionName><QName>dba:user-update</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN>
  <ParamList><Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName>     <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param><TOKEN>,</TOKEN>
  <Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName>  <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param><TOKEN>,</TOKEN>
  <Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>pw</QName></FunctionName></QName></EQName>       <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param><TOKEN>,</TOKEN>
  <Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>perm</QName></FunctionName></QName></EQName>     <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param><TOKEN>,</TOKEN>
  <Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName>     <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param></ParamList>
<TOKEN>)</TOKEN> <TOKEN>as</TOKEN> <SequenceType><TOKEN>empty-sequence</TOKEN><TOKEN>(</TOKEN><TOKEN>)</TOKEN></SequenceType> <FunctionBody><EnclosedExpr><TOKEN>{</TOKEN>
  <Expr><ExprSingle><TryCatchExpr><TryClause><TOKEN>try</TOKEN> <EnclosedTryTargetExpr><EnclosedExpr><TOKEN>{</TOKEN>
    <Expr><ExprSingle><FLWORExpr><InitialClause><LetClause><TOKEN>let</TOKEN> <LetBinding><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>old</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:list-details</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></LetBinding></LetClause></InitialClause>
    <ReturnClause><TOKEN>return</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
      (: change name of user :)
      <Expr><ExprSingle><IfExpr><TOKEN>if</TOKEN><TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr> <GeneralComp><TOKEN>=</TOKEN></GeneralComp> <FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
        <Expr><ExprSingle><IfExpr><TOKEN>if</TOKEN><TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:exists</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
           <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>error</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'User already exists.'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
         <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
           <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:alter</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
        <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle></Expr>
      <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle><TOKEN>,</TOKEN>
      (: change password :)
      <ExprSingle><IfExpr><TOKEN>if</TOKEN><TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>pw</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr> <GeneralComp><TOKEN>=</TOKEN></GeneralComp> <FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>''</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:password</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>pw</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle><TOKEN>,</TOKEN>
      (: change permissions :)
      <ExprSingle><IfExpr><TOKEN>if</TOKEN><TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>perm</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr> <GeneralComp><TOKEN>=</TOKEN></GeneralComp> <FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>old</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr><TOKEN>/</TOKEN><StepExpr><AxisStep><ForwardStep><AbbrevForwardStep><TOKEN>@</TOKEN><NodeTest><NameTest><EQName><QName><FunctionName><QName>permission</QName></FunctionName></QName></EQName></NameTest></NodeTest></AbbrevForwardStep></ForwardStep><PredicateList/></AxisStep></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:grant</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>perm</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle><TOKEN>,</TOKEN>
      (: change user info :)
      <ExprSingle><FLWORExpr><InitialClause><LetClause><TOKEN>let</TOKEN> <LetBinding><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>dba:user-info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></LetBinding></LetClause></InitialClause>
      <IntermediateClause><WhereClause><TOKEN>where</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>not</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>deep-equal</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></WhereClause></IntermediateClause>
      <ReturnClause><TOKEN>return</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>user:update-info</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>xml</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></ReturnClause></FLWORExpr></ExprSingle></Expr>
    <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></ReturnClause></FLWORExpr></ExprSingle><TOKEN>,</TOKEN>
    <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>util:redirect</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:SUB</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><MapConstructor><TOKEN>map</TOKEN> <TOKEN>{</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'name'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry><TOKEN>,</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'info'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'User was updated.'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry> <TOKEN>}</TOKEN></MapConstructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>}</TOKEN></EnclosedExpr></EnclosedTryTargetExpr></TryClause> <CatchClause><TOKEN>catch</TOKEN> <CatchErrorList><NameTest><Wildcard>*</Wildcard></NameTest></CatchErrorList> <EnclosedExpr><TOKEN>{</TOKEN>
    <Expr><ExprSingle><FLWORExpr><InitialClause><LetClause><TOKEN>let</TOKEN> <LetBinding><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>error</QName></FunctionName></QName></EQName></VarName> <TOKEN>:=</TOKEN> <ExprSingle><IfExpr><TOKEN>if</TOKEN> <TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>err:code</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr> <GeneralComp><TOKEN>!=</TOKEN></GeneralComp> <FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>xs:QName</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'err:FODC0006'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>err:description</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN>
      <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'XML with "info" root element expected.'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle></LetBinding></LetClause></InitialClause>
    <ReturnClause><TOKEN>return</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>util:redirect</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>dba:SUB</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>,</TOKEN> <Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><MapConstructor><TOKEN>map</TOKEN> <TOKEN>{</TOKEN>
      <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'name'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>name</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry><TOKEN>,</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'newname'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>newname</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry><TOKEN>,</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'pw'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>pw</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry><TOKEN>,</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'perm'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>perm</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry><TOKEN>,</TOKEN> <MapConstructorEntry><MapKeyExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Literal><StringLiteral>'error'</StringLiteral></Literal></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapKeyExpr><TOKEN>:</TOKEN> <MapValueExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>error</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></MapValueExpr></MapConstructorEntry>
    <TOKEN>}</TOKEN></MapConstructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></ReturnClause></FLWORExpr></ExprSingle></Expr>
  <TOKEN>}</TOKEN></EnclosedExpr></CatchClause></TryCatchExpr></ExprSingle></Expr>
<TOKEN>}</TOKEN></EnclosedExpr></FunctionBody></FunctionDecl></AnnotatedDecl><Separator><TOKEN>;</TOKEN></Separator>

(:~
 : Converts a user info string to XML.
 : @param  $info  user info
 : @return info element
 :)
<AnnotatedDecl><TOKEN>declare</TOKEN> <Annotation><TOKEN>%</TOKEN><EQName><QName><FunctionName><QName>private</QName></FunctionName></QName></EQName></Annotation> <FunctionDecl><TOKEN>function</TOKEN> <EQName><QName><FunctionName><QName>dba:user-info</QName></FunctionName></QName></EQName><TOKEN>(</TOKEN>
  <ParamList><Param><TOKEN>$</TOKEN><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName>  <TypeDeclaration><TOKEN>as</TOKEN> <SequenceType><ItemType><AtomicOrUnionType><EQName><QName><FunctionName><QName>xs:string</QName></FunctionName></QName></EQName></AtomicOrUnionType></ItemType></SequenceType></TypeDeclaration></Param></ParamList>
<TOKEN>)</TOKEN> <TOKEN>as</TOKEN> <SequenceType><ItemType><KindTest><ElementTest><TOKEN>element</TOKEN><TOKEN>(</TOKEN><ElementNameOrWildcard><ElementName><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></ElementName></ElementNameOrWildcard><TOKEN>)</TOKEN></ElementTest></KindTest></ItemType></SequenceType> <FunctionBody><EnclosedExpr><TOKEN>{</TOKEN>
  <Expr><ExprSingle><IfExpr><TOKEN>if</TOKEN><TOKEN>(</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>)</TOKEN> <TOKEN>then</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
    <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>parse-xml</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><VarRef><TOKEN>$</TOKEN><VarName><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></VarName></VarRef></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr><TOKEN>/</TOKEN><StepExpr><AxisStep><ForwardStep><AbbrevForwardStep><NodeTest><NameTest><Wildcard>*</Wildcard></NameTest></NodeTest></AbbrevForwardStep></ForwardStep><PredicateList><Predicate><TOKEN>[</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><AxisStep><ForwardStep><ForwardAxis><TOKEN>self</TOKEN><TOKEN>::</TOKEN></ForwardAxis><NodeTest><NameTest><EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName></NameTest></NodeTest></ForwardStep> <PredicateList/></AxisStep></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr><TOKEN>or</TOKEN> <AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>error</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>xs:QName</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><AxisStep><ForwardStep><AbbrevForwardStep><NodeTest><NameTest><EQName><QName><FunctionName><QName>err:FODC0006</QName></FunctionName></QName></EQName></NameTest></NodeTest></AbbrevForwardStep></ForwardStep><PredicateList/></AxisStep></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>]</TOKEN></Predicate></PredicateList></AxisStep></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr> <TOKEN>update</TOKEN> <TOKEN>{</TOKEN>
      <Expr><ExprSingle><DeleteExpr><TOKEN>delete</TOKEN> <TOKEN>node</TOKEN> <TargetExpr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ContextItemExpr><TOKEN>.</TOKEN></ContextItemExpr></PrimaryExpr></PostfixExpr></StepExpr><TOKEN>//</TOKEN><StepExpr><AxisStep><ForwardStep><AbbrevForwardStep><NodeTest><KindTest><TextTest><TOKEN>text</TOKEN><TOKEN>(</TOKEN><TOKEN>)</TOKEN></TextTest></KindTest></NodeTest></AbbrevForwardStep></ForwardStep><PredicateList><Predicate><TOKEN>[</TOKEN><Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>not</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><Argument><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><FunctionCall><FunctionEQName><FunctionName><QName>normalize-space</QName></FunctionName></FunctionEQName><ArgumentList><TOKEN>(</TOKEN><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Argument><TOKEN>)</TOKEN></ArgumentList></FunctionCall></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr><TOKEN>]</TOKEN></Predicate></PredicateList></AxisStep></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></TargetExpr></DeleteExpr></ExprSingle></Expr>
    <TOKEN>}</TOKEN></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle> <TOKEN>else</TOKEN> <ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><ParenthesizedExpr><TOKEN>(</TOKEN>
    <Expr><ExprSingle><OrExpr><AndExpr><ComparisonExpr><FTContainsExpr><StringConcatExpr><RangeExpr><AdditiveExpr><MultiplicativeExpr><UnionExpr><IntersectExceptExpr><InstanceofExpr><TreatExpr><CastableExpr><CastExpr><TransformWithExpr><BasexUpdate1Expr><BasexUpdateExpr><ArrowExpr><UnaryExpr><ValueExpr><SimpleMapExpr><PathExpr><RelativePathExpr><StepExpr><PostfixExpr><PrimaryExpr><Constructor><ComputedConstructor><CompElemConstructor><TOKEN>element</TOKEN> <EQName><QName><FunctionName><QName>info</QName></FunctionName></QName></EQName> <EnclosedContentExpr><EnclosedExpr><TOKEN>{</TOKEN><TOKEN>}</TOKEN></EnclosedExpr></EnclosedContentExpr></CompElemConstructor></ComputedConstructor></Constructor></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></Expr>
  <TOKEN>)</TOKEN></ParenthesizedExpr></PrimaryExpr></PostfixExpr></StepExpr></RelativePathExpr></PathExpr></SimpleMapExpr></ValueExpr></UnaryExpr></ArrowExpr></BasexUpdateExpr></BasexUpdate1Expr></TransformWithExpr></CastExpr></CastableExpr></TreatExpr></InstanceofExpr></IntersectExceptExpr></UnionExpr></MultiplicativeExpr></AdditiveExpr></RangeExpr></StringConcatExpr></FTContainsExpr></ComparisonExpr></AndExpr></OrExpr></ExprSingle></IfExpr></ExprSingle></Expr>
<TOKEN>}</TOKEN></EnclosedExpr></FunctionBody></FunctionDecl></AnnotatedDecl><Separator><TOKEN>;</TOKEN></Separator></Prolog></LibraryModule></Module>
<EOF/></XQuery>